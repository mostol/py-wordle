<!--
Scripting and general setup based on LING50 Sanskrit example project:
https://github.com/jjberry-508/sanskrit-508/blob/week6/web/sanskrit.html
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PyWordle - Guess generator</title>
</head>
<body>
<h1>PyWordle guess generator</h1>

<h2>Game state input:</h2>
<p>
    Input the current game state by providing any words you've guessed so far,
 along with the color of each letter in the guesses.
</p>

<p>
    Guess(es) are optional. If no guesses are provided, we'll try to return
    the best initial guess.
</p>

<form id="input" action="http://127.0.0.1:5000/" method="POST">
    <fieldset>
        <legend>Guess 1</legend>
        <label for="word">Word (5 letters):</label>
        <input type="text" id="word" name="word" required minlength="5" maxlength="5" size="5">

        <label>Letter colors:</label>
        <select name="ch1.1">
            <option value="b">Black</option>
            <option value="y">Yellow</option>
            <option value="g">Green</option>
        </select>
        <select name="ch1.2">
            <option value="b">Black</option>
            <option value="y">Yellow</option>
            <option value="g">Green</option>
        </select>
        <select name="ch1.3">
            <option value="b">Black</option>
            <option value="y">Yellow</option>
            <option value="g">Green</option>
        </select>
        <select name="ch1.4">
            <option value="b">Black</option>
            <option value="y">Yellow</option>
            <option value="g">Green</option>
        </select>
        <select name="ch1.5">
            <option value="b">Black</option>
            <option value="y">Yellow</option>
            <option value="g">Green</option>
        </select>
    </fieldset>
    <div>
        <button>Submit</button>
    </div>
</form>
<p>(â€¦multi-guess input in development)</p>

<h2>Result:</h2>
<output form="input" name="output">
    ???
</output>

</body>
<script>
async function handleSubmit1(event) {
    event.preventDefault();

    const data = new FormData(event.target);
    const value = Object.fromEntries(data.entries());
    value.word = data.get("word");
    console.log({value});

    const response = await fetch('http://localhost:5000/parse', {
        method: 'POST',
        body: JSON.stringify(value),
        headers: {
            'Content-Type': 'application/json',
            }
        });
    const myJson = await response.json();
    console.log(myJson);
    document.getElementById('response').textContent = JSON.stringify(myJson, undefined, 2);
}
const form1 = document.getElementById("form1");
form1.addEventListener("submit", async (e) => handleSubmit1(e), false);

async function handleSubmit2(event) {
    event.preventDefault();

    const data = new FormData(event.target);
    const value = Object.fromEntries(data.entries());
    value.compound = data.get("compound");
    console.log({value});

    const response = await fetch('http://localhost:5000/segment', {
        method: 'POST',
        body: JSON.stringify(value),
        headers: {
            'Content-Type': 'application/json',
            }
        });
    const myJson = await response.json();
    console.log(myJson);
    document.getElementById('segments').textContent = JSON.stringify(myJson, undefined, 2);
}
const form2 = document.getElementById("form2");
form2.addEventListener("submit", async (e) => handleSubmit2(e), false);
</script>
</html>